{% extends "base.html" %}
{% block title %}{{ dish.name }}{% endblock %}
{% block content %}

<style>
.recipe-top { display: flex; gap: 50px; margin-bottom: 30px; }
.recipe-card-img { position: relative; width: 300px; border-radius: var(--border-radius-main); overflow: hidden; }
.recipe-card-img img { width: 100%; height: 360px; object-fit: cover; }
.recipe-card-name { position: absolute; top: 0; left: 0; right: 0; background: rgba(255,255,255,0.88); text-align: center; font-weight: 700; padding: 10px; }
.recipe-card-meta { position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.45); color: white; text-align: center; padding: 10px; }
.recipe-info { flex: 1; }
.recipe-ingredients { background: white; border-radius: var(--border-radius-main); padding: 20px 28px; margin-bottom: 30px; }

/* Стилі для секції відгуків */
.reviews-section { background: white; border-radius: var(--border-radius-main); padding: 20px 28px; margin-top: 30px; }
.review-item { border-bottom: 1px solid #eee; padding: 15px 0; }
.review-item:last-child { border-bottom: none; }
.btn-review { display: inline-block; padding: 10px 20px; background: #b8a080; color: white; text-decoration: none; border-radius: 8px; margin-top: 15px; transition: background 0.2s; }
.btn-review:hover { background: #a08060; }
</style>

<div class="recipe-page">

    <div class="recipe-top">
        <div class="recipe-card-img">
            <div class="recipe-card-name">{{ dish.name }}</div>
            <img src="{{ url_for('static', path='images/' + dish.image) }}" alt="{{ dish.name }}">
            <div class="recipe-card-meta">
                <span>Час приготування : {{ dish.cooking_time }} хв</span>
                <span>Ккал : {{ dish.calories }}</span>
            </div>
        </div>

        <div class="recipe-info">
            <div class="recipe-rating">
                <h1>Загальна оцінка: {{ dish.rating }} / 10</h1>
            </div>

            <div class="recipe-steps">
                <p class="steps-title">Кроки приготування:</p>
                <ol>
                    {% for step in steps %}
                    <li>{{ step }}</li>
                    {% endfor %}
                </ol>
            </div>
        </div>
    </div>

    <div class="recipe-ingredients">
        <p class="ingredients-title">Інгредієнти ({{ dish.servings }} порції):</p>
        <ul>
            {% for ingredient in ingredients %}
            <li>{{ ingredient }}</li>
            {% endfor %}
        </ul>
    </div>

    <div class="reviews-section">
        <h2>Відгуки</h2>

        {% if reviews %}
            {% for review in reviews %}
            <div class="review-item">
                <strong>{{ review.author.username }}</strong> (Оцінка: {{ review.rating }}/10)
                <p style="margin-top: 8px;">{{ review.text }}</p>
            </div>
            {% endfor %}
        {% else %}
            <p>Поки що немає відгуків. Будьте першим!</p>
        {% endif %}

        <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee;">

        {% if user %}
            <a href="/recipe/{{ dish.id }}/review" class="btn-review">Написати відгук</a>
        {% else %}
            <p>Щоб залишити відгук, будь ласка, <a href="/login" style="color: #b8a080; font-weight: bold;">увійдіть в акаунт</a>.</p>
        {% endif %}
    </div>

</div>

{% endblock %}
